<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ECE297 Storage Server: storage.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ECE297 Storage Server
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">storage.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file defines the interface between the storage client and server.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
</div>
<p><a href="storage_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstorage__record.html">storage_record</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encapsulate the value associated with a key in a table.  <a href="structstorage__record.html#details">More...</a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7186273cd88640b740b6333cd98ae243"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7186273cd88640b740b6333cd98ae243"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a7186273cd88640b740b6333cd98ae243">MAX_CONFIG_LINE_LEN</a>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:a7186273cd88640b740b6333cd98ae243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters in each config file line. <br/></td></tr>
<tr class="memitem:a6c4647395896246d6710ba980c31666c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c4647395896246d6710ba980c31666c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a6c4647395896246d6710ba980c31666c">MAX_USERNAME_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr class="memdesc:a6c4647395896246d6710ba980c31666c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of server username. <br/></td></tr>
<tr class="memitem:aa13f93b74a500b0fd36cf2fd2fa5f30b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa13f93b74a500b0fd36cf2fd2fa5f30b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#aa13f93b74a500b0fd36cf2fd2fa5f30b">MAX_ENC_PASSWORD_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr class="memdesc:aa13f93b74a500b0fd36cf2fd2fa5f30b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of server's encrypted password. <br/></td></tr>
<tr class="memitem:aa746ad89d7f59a152f37e3529057bd58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa746ad89d7f59a152f37e3529057bd58"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#aa746ad89d7f59a152f37e3529057bd58">MAX_HOST_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr class="memdesc:aa746ad89d7f59a152f37e3529057bd58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of server hostname. <br/></td></tr>
<tr class="memitem:a374d6c9cec689b490a1c753145379723"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a374d6c9cec689b490a1c753145379723"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a374d6c9cec689b490a1c753145379723">MAX_PORT_LEN</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:a374d6c9cec689b490a1c753145379723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of server port. <br/></td></tr>
<tr class="memitem:abdd33f362ae3bbdacb5de76473aa8a2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abdd33f362ae3bbdacb5de76473aa8a2f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#abdd33f362ae3bbdacb5de76473aa8a2f">MAX_PATH_LEN</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:abdd33f362ae3bbdacb5de76473aa8a2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of data directory path. <br/></td></tr>
<tr class="memitem:a6f4cdd0162e9f2ab251fa5b23410c8da"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f4cdd0162e9f2ab251fa5b23410c8da"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a6f4cdd0162e9f2ab251fa5b23410c8da">MAX_TABLES</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:a6f4cdd0162e9f2ab251fa5b23410c8da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max tables supported by the server. <br/></td></tr>
<tr class="memitem:ad02d7128cbc04a5ec5ee79c6beb66730"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad02d7128cbc04a5ec5ee79c6beb66730"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ad02d7128cbc04a5ec5ee79c6beb66730">MAX_RECORDS_PER_TABLE</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:ad02d7128cbc04a5ec5ee79c6beb66730"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max records per table. <br/></td></tr>
<tr class="memitem:ae7854bc280576d57ec5c80995d5ea94c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae7854bc280576d57ec5c80995d5ea94c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ae7854bc280576d57ec5c80995d5ea94c">MAX_TABLE_LEN</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:ae7854bc280576d57ec5c80995d5ea94c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of a table name. <br/></td></tr>
<tr class="memitem:ad91bfaf106e42aa552f1605c5b8a9ef2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad91bfaf106e42aa552f1605c5b8a9ef2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ad91bfaf106e42aa552f1605c5b8a9ef2">MAX_KEY_LEN</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:ad91bfaf106e42aa552f1605c5b8a9ef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of a key name. <br/></td></tr>
<tr class="memitem:a053b7859476cc9867ec62c49e68d3fa1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a053b7859476cc9867ec62c49e68d3fa1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a053b7859476cc9867ec62c49e68d3fa1">MAX_CONNECTIONS</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:a053b7859476cc9867ec62c49e68d3fa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max simultaneous client connections. <br/></td></tr>
<tr class="memitem:a2c806bc7de304d1d07bb12c9d58dbdd1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c806bc7de304d1d07bb12c9d58dbdd1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a2c806bc7de304d1d07bb12c9d58dbdd1">MAX_COLUMNS_PER_TABLE</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:a2c806bc7de304d1d07bb12c9d58dbdd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max columns per table. <br/></td></tr>
<tr class="memitem:a5cced553ee7679aebe25952d79c7b86b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cced553ee7679aebe25952d79c7b86b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a5cced553ee7679aebe25952d79c7b86b">MAX_COLNAME_LEN</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:a5cced553ee7679aebe25952d79c7b86b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of a column name. <br/></td></tr>
<tr class="memitem:ab9cbe6531d78ffac767508924ec1b5ac"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab9cbe6531d78ffac767508924ec1b5ac"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ab9cbe6531d78ffac767508924ec1b5ac">MAX_STRTYPE_SIZE</a>&#160;&#160;&#160;40</td></tr>
<tr class="memdesc:ab9cbe6531d78ffac767508924ec1b5ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max SIZE of string types. <br/></td></tr>
<tr class="memitem:a00a29850f2b5b985f776f864d83e5ac3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a00a29850f2b5b985f776f864d83e5ac3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a00a29850f2b5b985f776f864d83e5ac3">MAX_VALUE_LEN</a>&#160;&#160;&#160;800</td></tr>
<tr class="memdesc:a00a29850f2b5b985f776f864d83e5ac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max characters of a value. <br/></td></tr>
<tr class="memitem:ad633b9edd00d2bf59ace1af24cc483f4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad633b9edd00d2bf59ace1af24cc483f4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ad633b9edd00d2bf59ace1af24cc483f4">ERR_INVALID_PARAM</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ad633b9edd00d2bf59ace1af24cc483f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A parameter is not valid. <br/></td></tr>
<tr class="memitem:aeef6b01ffc4d49ae7b4a2e17eefb4ade"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeef6b01ffc4d49ae7b4a2e17eefb4ade"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#aeef6b01ffc4d49ae7b4a2e17eefb4ade">ERR_CONNECTION_FAIL</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:aeef6b01ffc4d49ae7b4a2e17eefb4ade"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error connecting to server. <br/></td></tr>
<tr class="memitem:ab03e83c2f65be8b009eff331f370058d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab03e83c2f65be8b009eff331f370058d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ab03e83c2f65be8b009eff331f370058d">ERR_NOT_AUTHENTICATED</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ab03e83c2f65be8b009eff331f370058d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Client not authenticated. <br/></td></tr>
<tr class="memitem:a3ff770fb1d0d1d37b43e6a27f85a7cd1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ff770fb1d0d1d37b43e6a27f85a7cd1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a3ff770fb1d0d1d37b43e6a27f85a7cd1">ERR_AUTHENTICATION_FAILED</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:a3ff770fb1d0d1d37b43e6a27f85a7cd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Client authentication failed. <br/></td></tr>
<tr class="memitem:ab1c0830c9f58e53bf4a9ff593a24b761"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab1c0830c9f58e53bf4a9ff593a24b761"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ab1c0830c9f58e53bf4a9ff593a24b761">ERR_TABLE_NOT_FOUND</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ab1c0830c9f58e53bf4a9ff593a24b761"><td class="mdescLeft">&#160;</td><td class="mdescRight">The table does not exist. <br/></td></tr>
<tr class="memitem:afd0cce588bf32d57085d8d0a28bd8e34"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd0cce588bf32d57085d8d0a28bd8e34"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#afd0cce588bf32d57085d8d0a28bd8e34">ERR_KEY_NOT_FOUND</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:afd0cce588bf32d57085d8d0a28bd8e34"><td class="mdescLeft">&#160;</td><td class="mdescRight">The key does not exist. <br/></td></tr>
<tr class="memitem:a60d04c865fd58d86758894edca38bf30"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a60d04c865fd58d86758894edca38bf30"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a60d04c865fd58d86758894edca38bf30">ERR_UNKNOWN</a>&#160;&#160;&#160;7</td></tr>
<tr class="memdesc:a60d04c865fd58d86758894edca38bf30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Any other error. <br/></td></tr>
<tr class="memitem:a31edc5f52b2c941d356fda0e409272ef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a31edc5f52b2c941d356fda0e409272ef"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a31edc5f52b2c941d356fda0e409272ef">ERR_TRANSACTION_ABORT</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:a31edc5f52b2c941d356fda0e409272ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transaction abort error. <br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc3751ffba629aad5a4b8c7c22a75e11"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#abc3751ffba629aad5a4b8c7c22a75e11">storage_connect</a> (const char *hostname, const int port)</td></tr>
<tr class="memdesc:abc3751ffba629aad5a4b8c7c22a75e11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish a connection to the server.  <a href="#abc3751ffba629aad5a4b8c7c22a75e11"></a><br/></td></tr>
<tr class="memitem:aa97b5545b3eefb5055a4e6febd375796"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#aa97b5545b3eefb5055a4e6febd375796">storage_auth</a> (const char *username, const char *passwd, void *conn)</td></tr>
<tr class="memdesc:aa97b5545b3eefb5055a4e6febd375796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticate the client's connection to the server.  <a href="#aa97b5545b3eefb5055a4e6febd375796"></a><br/></td></tr>
<tr class="memitem:ac75689ee50898a2f6580c6489e886b59"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#ac75689ee50898a2f6580c6489e886b59">storage_get</a> (const char *table, const char *key, struct <a class="el" href="structstorage__record.html">storage_record</a> *record, void *conn)</td></tr>
<tr class="memdesc:ac75689ee50898a2f6580c6489e886b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the value associated with a key in a table.  <a href="#ac75689ee50898a2f6580c6489e886b59"></a><br/></td></tr>
<tr class="memitem:a8a42f72670cdcd7bf83416df1f1b090d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#a8a42f72670cdcd7bf83416df1f1b090d">storage_set</a> (const char *table, const char *key, struct <a class="el" href="structstorage__record.html">storage_record</a> *record, void *conn)</td></tr>
<tr class="memdesc:a8a42f72670cdcd7bf83416df1f1b090d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store a key/value pair in a table.  <a href="#a8a42f72670cdcd7bf83416df1f1b090d"></a><br/></td></tr>
<tr class="memitem:af4e09b41d2bc5b8c25936fe952e748b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#af4e09b41d2bc5b8c25936fe952e748b2">storage_query</a> (const char *table, const char *predicates, char **keys, const int max_keys, void *conn)</td></tr>
<tr class="memdesc:af4e09b41d2bc5b8c25936fe952e748b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the table for records, and retrieve the matching keys.  <a href="#af4e09b41d2bc5b8c25936fe952e748b2"></a><br/></td></tr>
<tr class="memitem:acd449536193542befbae2ff5e916f657"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="storage_8h.html#acd449536193542befbae2ff5e916f657">storage_disconnect</a> (void *conn)</td></tr>
<tr class="memdesc:acd449536193542befbae2ff5e916f657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the connection to the server.  <a href="#acd449536193542befbae2ff5e916f657"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This file defines the interface between the storage client and server. </p>
<p>The functions here should be implemented in <a class="el" href="storage_8c.html" title="This file contains the implementation of the storage server interface as specified in storage...">storage.c</a>.</p>
<p><b>You should not modify this file, or else the code used to mark your implementation will break.</b> </p>

<p>Definition in file <a class="el" href="storage_8h_source.html">storage.h</a>.</p>
</div><h2>Function Documentation</h2>
<a class="anchor" id="aa97b5545b3eefb5055a4e6febd375796"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int storage_auth </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>passwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authenticate the client's connection to the server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">username</td><td>Username to access the storage server. </td></tr>
    <tr><td class="paramname">passwd</td><td>Password in its plain text form. </td></tr>
    <tr><td class="paramname">conn</td><td>A connection to the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if successful, and -1 otherwise.</dd></dl>
<p>On error, errno will be set to ERR_AUTHENTICATION_FAILED. </p>

<p>Definition at line <a class="el" href="storage_8c_source.html#l00070">70</a> of file <a class="el" href="storage_8c_source.html">storage.c</a>.</p>

<p>References <a class="el" href="client_8c_source.html#l00016">ClientFile</a>, <a class="el" href="utils_8c_source.html#l00135">generate_encrypted_password()</a>, <a class="el" href="utils_8c_source.html#l00129">logger()</a>, <a class="el" href="utils_8h_source.html#l00024">MAX_CMD_LEN</a>, <a class="el" href="utils_8c_source.html#l00037">recvline()</a>, and <a class="el" href="utils_8c_source.html#l00017">sendall()</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l00024">main()</a>.</p>

</div>
</div>
<a class="anchor" id="abc3751ffba629aad5a4b8c7c22a75e11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* storage_connect </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish a connection to the server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hostname</td><td>The IP address or hostname of the server. </td></tr>
    <tr><td class="paramname">port</td><td>The TCP port of the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If successful, return a pointer to a data structure that represents a connection to the server. Otherwise return NULL.</dd></dl>
<p>On error, errno will be set to one of the following, as appropriate: ERR_INVALID_PARAM, ERR_CONNECTION_FAIL, or ERR_UNKNOWN. </p>

<p>Definition at line <a class="el" href="storage_8c_source.html#l00027">27</a> of file <a class="el" href="storage_8c_source.html">storage.c</a>.</p>

<p>References <a class="el" href="client_8c_source.html#l00016">ClientFile</a>, <a class="el" href="utils_8c_source.html#l00129">logger()</a>, and <a class="el" href="storage_8h_source.html#l00022">MAX_PORT_LEN</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l00024">main()</a>.</p>

</div>
</div>
<a class="anchor" id="acd449536193542befbae2ff5e916f657"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int storage_disconnect </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the connection to the server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>A pointer to the connection structure returned in an earlier call to <a class="el" href="storage_8c.html#abc3751ffba629aad5a4b8c7c22a75e11" title="Establish a connection to the server.">storage_connect()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if successful, and -1 otherwise.</dd></dl>
<p>On error, errno will be set to one of the following, as appropriate: ERR_INVALID_PARAM, ERR_CONNECTION_FAIL, or ERR_UNKNOWN. </p>

<p>Definition at line <a class="el" href="storage_8c_source.html#l00170">170</a> of file <a class="el" href="storage_8c_source.html">storage.c</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l00024">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ac75689ee50898a2f6580c6489e886b59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int storage_get </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstorage__record.html">storage_record</a> *&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the value associated with a key in a table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>A table in the database. </td></tr>
    <tr><td class="paramname">key</td><td>A key in the table. </td></tr>
    <tr><td class="paramname">record</td><td>A pointer to a record struture. </td></tr>
    <tr><td class="paramname">conn</td><td>A connection to the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if successful, and -1 otherwise.</dd></dl>
<p>On error, errno will be set to one of the following, as appropriate: ERR_INVALID_PARAM, ERR_CONNECTION_FAIL, ERR_TABLE_NOT_FOUND, ERR_KEY_NOT_FOUND, ERR_NOT_AUTHENTICATED, or ERR_UNKNOWN.</p>
<p>The record with the specified key in the specified table is retrieved from the server using the specified connection. If the key is found, the record structure is populated with the details of the corresponding record. Otherwise, the record structure is not modified. </p>

<p>Definition at line <a class="el" href="storage_8c_source.html#l00104">104</a> of file <a class="el" href="storage_8c_source.html">storage.c</a>.</p>

<p>References <a class="el" href="client_8c_source.html#l00016">ClientFile</a>, <a class="el" href="utils_8c_source.html#l00129">logger()</a>, <a class="el" href="utils_8h_source.html#l00024">MAX_CMD_LEN</a>, <a class="el" href="utils_8c_source.html#l00037">recvline()</a>, <a class="el" href="utils_8c_source.html#l00017">sendall()</a>, and <a class="el" href="storage_8h_source.html#l00056">storage_record::value</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l00024">main()</a>.</p>

</div>
</div>
<a class="anchor" id="af4e09b41d2bc5b8c25936fe952e748b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int storage_query </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>predicates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>max_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query the table for records, and retrieve the matching keys. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>A table in the database. </td></tr>
    <tr><td class="paramname">predicates</td><td>A comma separated list of predicates. </td></tr>
    <tr><td class="paramname">keys</td><td>An array of strings where the keys whose records match the specified predicates will be copied. The array must have room for at least max_keys elements. The caller must allocate memory for this array. </td></tr>
    <tr><td class="paramname">max_keys</td><td>The size of the keys array. </td></tr>
    <tr><td class="paramname">conn</td><td>A connection to the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return the number of matching keys (which may be more than max_keys) if successful, and -1 otherwise.</dd></dl>
<p>On error, errno will be set to one of the following, as appropriate: ERR_INVALID_PARAM, ERR_CONNECTION_FAIL, ERR_TABLE_NOT_FOUND, ERR_KEY_NOT_FOUND, ERR_NOT_AUTHENTICATED, or ERR_UNKNOWN.</p>
<p>Each predicate consists of a column name, an operator, and a value, each separated by optional whitespace. The operator may be a "=" for string types, or one of "&lt;, &gt;, =" for int and float types. An example of query predicates is "name = bob, mark &gt; 90". </p>

</div>
</div>
<a class="anchor" id="a8a42f72670cdcd7bf83416df1f1b090d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int storage_set </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structstorage__record.html">storage_record</a> *&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store a key/value pair in a table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>A table in the database. </td></tr>
    <tr><td class="paramname">key</td><td>A key in the table. </td></tr>
    <tr><td class="paramname">record</td><td>A pointer to a record struture. </td></tr>
    <tr><td class="paramname">conn</td><td>A connection to the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if successful, and -1 otherwise.</dd></dl>
<p>On error, errno will be set to one of the following, as appropriate: ERR_INVALID_PARAM, ERR_CONNECTION_FAIL, ERR_TABLE_NOT_FOUND, ERR_KEY_NOT_FOUND, ERR_NOT_AUTHENTICATED, or ERR_UNKNOWN.</p>
<p>The key and record are stored in the table of the database using the connection. If the key already exists in the table, the corresponding record is updated with the one specified here. If the key exists in the table and the record is NULL, the key/value pair are deleted from the table. </p>

<p>Definition at line <a class="el" href="storage_8c_source.html#l00138">138</a> of file <a class="el" href="storage_8c_source.html">storage.c</a>.</p>

<p>References <a class="el" href="client_8c_source.html#l00016">ClientFile</a>, <a class="el" href="utils_8c_source.html#l00129">logger()</a>, <a class="el" href="utils_8h_source.html#l00024">MAX_CMD_LEN</a>, <a class="el" href="utils_8c_source.html#l00037">recvline()</a>, <a class="el" href="utils_8c_source.html#l00017">sendall()</a>, and <a class="el" href="storage_8h_source.html#l00056">storage_record::value</a>.</p>

<p>Referenced by <a class="el" href="client_8c_source.html#l00024">main()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 29 2014 13:44:27 for ECE297 Storage Server by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
